<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>File Choice Demo - Paste String from Clipboard </title>
</head>
<body>


<div id="file-drop-area" class="fc-drop-area">
    <div class="fc-drop-area-inside">
        <div class="fc-disp-default">
            <p>You can paste an item (contains strings) from the clipboard as well as dropping a file.</p>
        </div>
        <div class="fc-disp-drag">
            <p>Drop here to add the file</p>
        </div>
        <div class="fc-disp-drag-not-allow">
            <p>The object cannot be dropped</p>
        </div>
        <p class="fc-visible-default">OR</p>
        <div class="fc-file-ref">
            <span>Select file</span>
        </div>
    </div>
</div>


<div id="image-preview"></div>

<div style="position:absolute;bottom:6px">Examples:<br>
    <a href="index.html">Top</a>&nbsp;|&nbsp;
    <a href="example01_multi_areas.html">01 Multi Areas</a>&nbsp;|&nbsp;
    <a href="example02_styling.html">02 Styling</a>&nbsp;|&nbsp;
    <a href="example03_very_simple.html">03 Very Simple</a>&nbsp;|&nbsp;
    <a href="example04_paste_image.html">04 Paste Image from Clipboard</a>&nbsp;|&nbsp;
    <a href="example05_paste_string.html">05 Paste String from Clipboard</a>&nbsp;|&nbsp;
</div>

<script src="js/file-choice.js"></script>
<script>


  const fnSanitize = (str) => {
    return String(str).replace(/&/g, "&amp;")
      .replace(/"/g, "&quot;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
  };

  const fileChoice = new FileChoice({
    pasteEnabled: true
  });

  fileChoice.events().on('paste', async (data) => {
    const clipboardItems = data.itemMap;

    const previewArea = document.querySelector('#image-preview');
    previewArea.innerHTML = '';

    let item = clipboardItems.get('text/html');
    if (!item) {
      // get the first item of the map
      item = clipboardItems.values().next().value;
    }

    const clipboardText = await fileChoice.getStringFromClipboardItemAsync(item);
    const div = document.createElement('div');
    div.style.border = 'solid 1px';
    div.style.fontSize = '10px';
    div.innerHTML = fnSanitize(clipboardText);
    previewArea.insertBefore(div, previewArea.firstChild);

  });

</script>
</body>
</html>
